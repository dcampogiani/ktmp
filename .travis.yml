matrix:
  include:
    - language: android
      dist: trusty
      script:
        - ./gradlew common:build app:testDebugUnitTest app:assembleDebug --console plain
      before_cache:
        - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
        - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
      cache:
        directories:
          - $HOME/.gradle/caches/
          - $HOME/.gradle/wrapper/
          - $HOME/.android/build-cache
    - language: swift
      os: osx
      osx_image: xcode11.3.1
      script:
        - ./gradlew common:build --console plain
        - cd native/KotlinIOS
        - xcodebuild \
          -project KotlinIOS.xcodeproj \
          -scheme KotlinIOS \
          -destination 'platform=iOS Simulator,name=iPhone 11 Pro Max,OS=13.4.1' \
          test | xcpretty --test --color
      after_failure:
        - cat xcodebuild.log
