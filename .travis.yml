matrix:
  include:
    - language: android
      os: osx
      jdk: openjdk8
      android:
        components:
          - tools
          - platform-tools
          - build-tools-28.0.3
          - android-28
      before_script:
        - cd android/AppName
      script:
        - ./gradlew common:build --console plain
        - ./gradlew app:testDebugUnitTest app:assembleDebug --console plain
      before_cache:
        - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
        - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
      cache:
        directories:
          - $HOME/.gradle/caches/
          - $HOME/.gradle/wrapper/
          - $HOME/.android/build-cache
    - language: swift
      os: osx
      osx_image: xcode11.2
      before_script:
        - cd native/KotlinIOS
      script:
        - ./gradlew common:build --console plain
        - xcodebuild -project KotlinIOS.xcodeproj -scheme KotlinIOS -destination 'platform=iOS Simulator,name=iPhone XR,OS=12.4'
      after_failure:
        - cat xcodebuild.log
